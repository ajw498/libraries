Mon Aug  5 21:08:24 2002  Joe Orton  <joe@manyfish.co.uk>

	* ssl.c (ccert_provider, client_cert_provided): New functions.
	(fail_load_ccerts): Enable function.

Sun Aug  4 22:32:43 2002  Joe Orton  <joe@manyfish.co.uk>

	* request.c (serve_abort, retry_after_abort): New functions.

Sun Aug  4 13:28:47 2002  Joe Orton  <joe@manyfish.co.uk>

	* request.c (continued_header): New function.

Sun Aug  4 12:54:52 2002  Joe Orton  <joe@manyfish.co.uk>

	* socket.c [SOCKET_SSL] (ssl_closure): New function; use instead
	of read_reset, write_reset for SOCKET_SSL build.

Sun Aug  4 12:27:34 2002  Joe Orton  <joe@manyfish.co.uk>

	Build socket.c twice, once for testing over SSL connections:

	* Makefile.in (socket-ssl.o, socket-ssl): New targets.
	(SSL_TESTS): Include socket-ssl target.

	* socket.c [SOCKET_SSL] (init_ssl, wrap_serve): New functions.
	[SOCKET_SSL] (begin): Alternate implementation.

Sat Aug  3 22:20:59 2002  Joe Orton  <joe@manyfish.co.uk>

	* session.c (privates): New function.

Sat Aug  3 22:20:14 2002  Joe Orton  <joe@manyfish.co.uk>

	* auth.c (fail_auth_cb, tunnel_regress): New function.

Sat Aug  3 22:12:48 2002  Joe Orton  <joe@manyfish.co.uk>

	* auth.c (forget_regress): New function.

Sun Jul 28 12:24:02 2002  Joe Orton  <joe@manyfish.co.uk>

	* lock.c (lock_timeout, submit_test, lock_shared): Use ne_concat,
	not CONCAT? macros.

	* ssl.c (init, fail_expired, fail_notvalid): Likewise.

Thu Jul 25 00:04:47 2002  Joe Orton  <joe@manyfish.co.uk>

	* string-tests.c (buf_concat, buf_concat2, buf_concat3): Renamed
	from concat, concat1, concat3).
	(concat): New function.

Sun Jul 14 11:42:03 2002  Joe Orton  <joe@manyfish.co.uk>

	* util-tests.c (versioning): New function.

Thu Jul 11 17:24:29 2002  Joe Orton  <joe@manyfish.co.uk>

	* request.c (no_headers): New function.

Wed Jul 10 22:58:01 2002  Joe Orton  <joe@manyfish.co.uk>

	* utils.c (any_2xx_request_body): New function.

Wed Jul 10 22:44:12 2002  Joe Orton  <joe@manyfish.co.uk>

	* request.c (ptimeout_eof, ptimeout_eof2, close_not_retried,
	serve_close2): New functions.
	(abort_respbody): Rejoin child earlier for reliable results.

Sun Jul  7 12:17:11 2002  Joe Orton  <joe@manyfish.co.uk>

	* socket.c (expect_eof): Better error reporting.
	(good_close): Split from finish().
	(finish): Use good_close.
	(expect_write_closed, write_reset, read_reset): Add tests that
	an ECONNRESET is treated as a SOCK_CLOSED failure.

Sun Jul  7 08:38:12 2002  Joe Orton  <joe@manyfish.co.uk>

	* utils.c (serve_response): Use discard_body().

Sun Jul  7 08:28:56 2002  Joe Orton  <joe@manyfish.co.uk>

	* socket.c (serve_expect, full_write, small_writes, large_writes,
	echo_server, echo_expect, echo_lines): New functions.

Sat Jul  6 13:11:33 2002  Joe Orton  <joe@manyfish.co.uk>

	* request.c (serve_eof, fail_early_eof, fail_eof_continued,
	fail_eof_headers): New functions.

Sat Jul  6 08:58:17 2002  Joe Orton  <joe@manyfish.co.uk>

	* request.c (serve_100_once, expect_100_once): New functions.

Fri Jul  5 21:43:58 2002  Joe Orton  <joe@manyfish.co.uk>

	* auth.c (username): Use the correct spelling of Aladdin.
	(auth_hdr): Simplify debug messages.
	(auth_serve): Fail if no Authorization header is given.
	(basic): Check for response status.

Fri Jul  5 21:41:02 2002  Joe Orton  <joe@manyfish.co.uk>

	* utils.c (any_2xx_request): New function.

Sun Jun 30 17:10:59 2002  Joe Orton  <joe@manyfish.co.uk>

	* request.c (fail_noserver): Factor out from host_not_found.
	(fail_lookup): Equivalent to old host_not_found.
	(fail_connect, abort_respbody): New function.

Sun Jun 30 14:32:32 2002  Joe Orton  <joe@manyfish.co.uk>

	* request.c (fail_chunksize): New function.

Sun Jun 30 10:39:17 2002  Joe Orton  <joe@manyfish.co.uk>

	* request.c (test_persist): Factor out from persist; take
	response and response body as arguments.
	(persist_http11): New function, equivalent to old persist.
	(persist_chunked, persist_http10): New functions.

Sun Jun 30 10:25:07 2002  Joe Orton  <joe@manyfish.co.uk>

	* utils.c (serve_response): Factor out from single_serve_string,
	many_serve_string.
	(single_serve_string, many_serve_string): Use serve_response.

Sun Jun 30 09:13:55 2002  Joe Orton  <joe@manyfish.co.uk>

	* request.c (expect_response, persist, persist_timeout,
	multi_header): Rely on the fact that the test framework
	will reap the server.
	(expect_no_body, no_body_304, no_body_204, no_body_HEAD,
	no_body_chunks): New functions.

Tue Jun 25 23:05:42 2002  Joe Orton  <joe@manyfish.co.uk>

	* request.c (trailing_header): New function.

Sun Jun 23 23:00:03 2002  Joe Orton  <joe@manyfish.co.uk>

	* ssl.c (no_verify): Fix sixth argument to any_ssl_request.

Sun Jun 23 15:21:06 2002  Joe Orton  <joe@manyfish.co.uk>

	* Makefile.in (grind): New target.

	* run.sh: Respect $HARNESS.

Sun Jun 23 15:20:38 2002  Joe Orton  <joe@manyfish.co.uk>

	* props.c: New file.

Sun Jun 23 09:37:10 2002  Joe Orton  <joe@manyfish.co.uk>

	* makekeys.sh: Ignore failure from `hostname -[sdf]' commands, as
	appropriate tests are skipped on failure.

Sun Jun 23 08:33:50 2002  Joe Orton  <joe@manyfish.co.uk>

	* request.c (host_not_found): Use any_request(); simplify.
	(proxy_no_resolve): New function.

Sun Jun 16 11:40:19 2002  Joe Orton  <joe@manyfish.co.uk>

	* ssl.c (do_ssl_response): Succeed if connection is closed
	by client after negotiation.
	(serve_tunnel, fail_tunnel, proxy_tunnel): New functions.

Mon Jun 10 21:18:03 2002  Joe Orton  <joe@manyfish.co.uk>

	* redirect.c (check_redir): Await server child before returning.

Sun Jun  9 13:05:25 2002  Joe Orton  <joe@manyfish.co.uk>

	* socket.c (DECL): Don't use run-time initialization.
	(single_read, single_peek, small_reads, read_and_peek, line_closure,
	larger_read, line_toolong): Use DECL, as last declaration.

Sun Jun  9 13:03:36 2002  Joe Orton  <joe@manyfish.co.uk>

	* compress.c (reader, do_fetch): Check that inflated data is of
	expected length.

Sun Jun  9 11:40:54 2002  Joe Orton  <joe@manyfish.co.uk>

	* redirect.c (struct redir_args): Add 'path' field.
	(any_request): Use path in Request-URI.
	(simple, redir_303, non_absolute): Fill in path.
	(relative_1, relative_2): New functions.

Tue Jun  4 16:56:08 2002  Joe Orton  <joe@manyfish.co.uk>

	* uri-tests.c (parents): Improve ne_path_parent tests.

Mon Jun  3 18:22:31 2002  Joe Orton  <joe@manyfish.co.uk>

	* cookies.c: New file.

Sun Jun  2 10:06:42 2002  Joe Orton  <joe@manyfish.co.uk>

	* basic.c (dav_capabilities): New function.

Sat Jun  1 10:39:04 2002  Joe Orton  <joe@manyfish.co.uk>

	* socket.c (to_begin, to_end, peek_timeout, read_timeout,
	readline_timeout, fullread_timeout): New functions.

Sat Jun  1 10:38:13 2002  Joe Orton  <joe@manyfish.co.uk>

	* request.c (read_timeout): Use sleepy_server.
	(hung_server): Removed.

Sat Jun  1 10:32:45 2002  Joe Orton  <joe@manyfish.co.uk>

	* utils.c (sleepy_server): New function.

Thu May 30 20:00:40 2002  Joe Orton  <joe@manyfish.co.uk>

	* socket.c (finish): New function, factored out from common code.
	(small_reads, read_and_peek, larger_read): Use it.
	(line_simple, line_closure, line_empty, line_toolong, line_mingle,
	line_chunked): New functions.

Sun May 26 14:54:52 2002  Joe Orton  <joe@manyfish.co.uk>

	* request.c (fill_uri, match_hostport, hostports): Moved functions
	to session.c.

	* session.c: New file.

Fri May 24 08:14:21 2002  Joe Orton  <joe@manyfish.co.uk>

	* request.c (match_hostport, hostports): New functions.

Tue May 21 21:29:25 2002  Joe Orton  <joe@manyfish.co.uk>

	* redirect.c: New file.

Sun May 19 18:25:48 2002  Joe Orton  <joe@manyfish.co.uk>

	* auth.c, lock.c, regress.c, socket.c, ssl.c, utils.c, utils.h:
	Update for socket API change; s/sock_/ne_sock_/,
	s/SOCK_/NE_SOCK_/.

Wed May  8 19:41:24 2002  Joe Orton  <joe@manyfish.co.uk>

	* ssl.c (do_ssl_response): Take response body as parameter; all
	callers changed.
	(serve_eof, simple_eof): New functions.	

Wed May  8 17:17:27 2002  Joe Orton  <joe@manyfish.co.uk>

	* socket.c: New file.

	* sock-tests.c: Removed file.

	* Makefile.in: Updated accordingly.

Wed May  8 11:53:35 2002  Joe Orton  <joe@manyfish.co.uk>

	* request.c (host_not_found): New function.

Wed May  1 21:41:02 2002  Joe Orton  <joe@manyfish.co.uk>

	* uri-tests.c (parse): New function.
	(simple, simple_ssl): Adjust for ne_uri_parse port default.

Tue Apr 23 21:39:09 2002  Joe Orton  <joe@manyfish.co.uk>

	* request.c (read_timeout): Better diagnostic for test failure
	cases.

Sun Apr 14 12:00:19 2002  Joe Orton  <joe@manyfish.co.uk>

	* basic.c (content_type): Updated to reflect default charset
	ISO-8859-1 for text/ media types.

Sun Apr  7 17:35:21 2002  Joe Orton  <joe@manyfish.co.uk>

	* run.sh: Set MALLOC_CHECK_ so glibc's heap corruption detection
	is enabled.

Sun Apr  7 17:30:37 2002  Joe Orton  <joe@manyfish.co.uk>

	* compress.c (do_fetch): Reset 'failed' flag to zero each time.

Wed Apr  3 20:16:43 2002  Joe Orton  <joe@manyfish.co.uk>

	* request.c (NO_BODY): Renamed from NOBODY (all callers changed).
	(empty_header, ignore_header_ws, ignore_header_ws2): New tests.
	(ignore_header_ws3): Renamed from ignore_header_spaces.	

Tue Apr  2 21:09:33 2002  Joe Orton  <joe@manyfish.co.uk>

	* request.c (expect_header_value): New function.
	 (ignore_header_case, ignore_header_spaces,
	ignore_header_tabs): New tests.

Mon Mar 25 21:51:24 2002  Joe Orton  <joe@manyfish.co.uk>

	* lock.c (multi_lock_response, lock_shared): New function.
	(lock_compare): Factored out from discover_results.
	(discover, lock_timeout, submit_test): Adjust for lock API
	changes.

Mon Mar 25 21:36:55 2002  Joe Orton  <joe@manyfish.co.uk>

	* ssl.c (fail_ssl_request): Check failure bits against
	NE_SSL_FAILMASK.

Sun Mar 10 22:07:48 2002  Joe Orton  <joe@manyfish.co.uk>

	* stubs.c (stub_decompress, sd_reader): New function.

Sun Mar 10 21:39:29 2002  Joe Orton  <joe@manyfish.co.uk>

	* lock.c (activelock): New function, factored out from
	lock_response.
	(lock_response): Use activelock; adjust argument types.
	(make_lock): Adjusted for lock_response arg changes.
	(discard_response, serve_discovery, discover_result, discover):
	New functions.

Wed Mar  6 22:22:04 2002  Joe Orton  <joe@manyfish.co.uk>

	* lock.c (submit_test): Handle failures gracefully.

Wed Mar  6 21:23:27 2002  Joe Orton  <joe@manyfish.co.uk>

	* lock.c (submit_test): Update to expect an absoluteURI in If:
	headers.

Wed Mar  6 21:17:37 2002  Joe Orton  <joe@manyfish.co.uk>

	* uri-tests.c (unparse): New function.

Tue Mar  5 22:59:37 2002  Joe Orton  <joe@manyfish.co.uk>

	* uri-tests.c (cmp): Checks for case-insensitive comparison, and
	empty path, "/" equivalence.

Mon Mar  4 01:07:03 2002  Joe Orton  <joe@manyfish.co.uk>

	* request.c (blank_response): Add test for potential segfault
	in strip_eol (would fail if run under Electric Fence).

Sun Mar  3 20:50:01 2002  Joe Orton  <joe@manyfish.co.uk>

	* lock.c (make_lock, store_single, store_several, got_if_header,
	serve_verify_if, do_request, submit_test, if_simple,
	if_under_infinite, if_infinite_over, if_child, if_covered_child):
	New tests.

	(lock_timeout): Adjusted for API changes.

Sun Mar  3 15:29:05 2002  Joe Orton  <joe@manyfish.co.uk>

	* uri-tests.c (cmp_differ, cmp): New functions.

Sun Mar  3 11:08:36 2002  Joe Orton  <joe@manyfish.co.uk>

	* request.c (fill_uri): New function.

Sun Feb 17 21:31:21 2002  Joe Orton  <joe@manyfish.co.uk>

	* ssl.c (fqdn_match): Removed test.

Sun Feb 17 20:32:16 2002  Joe Orton  <joe@manyfish.co.uk>

	* makekeys.sh: Create keypair for client cert.

	* ssl.c (do_ssl_response, any_ssl_request, all callers thereof):
	Better error handling.
	(serve_ccert, load_pem_ccert, keypw_prompt, load_pkcs12_ccert,
	fail_load_ccerts, client_cert_pem, client_cert_pkcs12): New
	functions.

Sun Feb 17 11:54:19 2002  Joe Orton  <joe@manyfish.co.uk>

	* basic.c (do_range): Factored out from
	get_range/fail_range_length.
	(get_range, fail_range_length): Use do_range.
	(fail_range_units, fail_range_notrange, fail_range_unsatify): New
	tests.

Sun Feb 17 11:36:00 2002  Joe Orton  <joe@manyfish.co.uk>

	* basic.c (get_range, fail_range_length): New functions.

Sat Feb 16 23:29:40 2002  Joe Orton  <joe@manyfish.co.uk>

	* xml.c: New file.

	* Makefile.in (DAV_TESTS): Add xml tests.

Sat Feb 16 15:26:27 2002  Joe Orton  <joe@manyfish.co.uk>

	* compress.c (do_fetch): Rename from fetch(); add 'expect_fail'
	paramater.  (fetch): Re-implement using do_fetch.
	(fail_trailing, fail_bad_csum, fail_truncate): New functions.

	* Makefile.in (trailing.gz, truncated.gz, badcsum.gz): New helper
	files.

Thu Feb 14 19:09:42 2002  Joe Orton  <joe@manyfish.co.uk>

	* request.c (everywhere): Simplify use of expect_response.

Thu Feb 14 19:05:48 2002  Joe Orton  <joe@manyfish.co.uk>

	* request.c (ignore_bad_headers): New function.

Mon Feb 11 22:06:40 2002  Joe Orton  <joe@manyfish.co.uk>

	* makekeys.sh: If the hostname command is clever enough to give
	FQDN, hostname, domainname, then create wildcard.cert; cert with a
	wildcard commonName.

	* ssl.c (wildcard_match): New function

Mon Feb 11 21:55:52 2002  Joe Orton  <joe@manyfish.co.uk>

	* ssl.c (any_ssl_request): Take session pointer, don't
	initialize here.  (DEFSESS): New macro.
	(everywhere): Use DEFSESS rather than passing pointer-to-
	session pointer.	

Mon Feb 11 20:44:44 2002  Joe Orton  <joe@manyfish.co.uk>

	* ssl.c (fqdn_match): Test for FQDN matching against non-qualified
	FQDN.
	(makekeys.sh): Create server cert with FQDN.

Sun Feb 10 12:36:55 2002  Joe Orton  <joe@manyfish.co.uk>

	* request.c (chunk_oversize): New function.

Sat Feb  9 21:12:47 2002  Joe Orton  <joe@manyfish.co.uk>

	* request.c (reason_phrase): New function.

Sat Feb  9 16:50:58 2002  Joe Orton  <joe@manyfish.co.uk>

	* request.c (read_timeout, hung_server): New functions.

Thu Feb  7 22:58:31 2002  Joe Orton  <joe@manyfish.co.uk>

	* ssl.c (cache_verify, no_verify, count_vfy): New functions.

Thu Feb  7 19:39:33 2002  Joe Orton  <joe@manyfish.co.uk>

	* ssl.c (any_ssl_request): Take server function as argument: all
	callers changed.
	(fail_ssl_request): Renamed from failreq; uses any_ssl_request.

Wed Feb  6 20:43:32 2002  Joe Orton  <joe@manyfish.co.uk>

	* ssl.c (load_ca): New function.

Wed Feb  6 20:36:15 2002  Joe Orton  <joe@manyfish.co.uk>

	* ssl.c (any_ssl_request): Make ca_cert and verify_fn arguments
	optional.
	(trustall): Removed function.
	(simple): Use the CA cert; no need for a verify function.
	(parse_cert): Don't give a CA cert, force use of verify function.
	(failreq): Bug fix, don't trust server cert as CA.
	(fail_wrongCN, fail_notvalid, fail_expired): Pass server cert
	as CA cert server cert is self-signed.

Tue Feb  5 20:33:42 2002  Joe Orton  <joe@manyfish.co.uk>

	* ssl.c (fail_untrusted_ca, fail_self_signed): New tests.
	(fail_serve): New function.
	(failreq, any_ssl_request): Take ca cert argument.
	(check_DNs, trustall, get_failures): Adjust for new verify
	callback interface.

Sat Feb  2 14:18:11 2002  Joe Orton  <joe@manyfish.co.uk>

	* ssl.c (do_ssl_response): Factored out from serve_ssl.
	(serve_ssl): Use do_ssl_response.
	(serve_scache, session_cache): New functions.

Thu Jan 31 21:09:58 2002  Joe Orton  <joe@manyfish.co.uk>

	* Makefile.in (ca-stamp): New target.

	* makekeys.sh: New helper script.

	* ssl.c (parse_cert, fail_wrongCN, fail_expired, fail_notvalid):
	New tests.
	(any_ssl_request, trustall, check_DNs, failreq): New auxiliaries.

Thu Jan 31 20:42:38 2002  Joe Orton  <joe@manyfish.co.uk>

	* wrongcn.pem, notvalid.pem, expired.pem, server.key: New files.

	* Makefile.in: Remove targets to generate certs.

Wed Jan 30 21:15:33 2002  Joe Orton  <joe@manyfish.co.uk>

	* Makefile.in (wrongcn.pem): New target.

Wed Jan 30 19:58:18 2002  Joe Orton  <joe@manyfish.co.uk>

	* string-tests.c: Updated for ne_buffer API change.

Sat Jan 26 11:23:34 2002  Joe Orton  <joe@manyfish.co.uk>

	* Makefile.in: Pick up appropriate TESTS, HELPERS from configure.
	(ssltests*, davtests*): Remove crud.

	* compress.c: Presume zlib support present if built.

Sun Jan 20 23:29:37 2002  Joe Orton  <joe@manyfish.co.uk>

	* ssl.c: New file.

	* Makefile.in (ssltests-no, ssltests-yes, server.pem, server.key):
	New targets.
	(check): Conditionally run SSL tests.

Sun Jan 20 13:20:56 2002  Joe Orton  <joe@manyfish.co.uk>

	* Makefile.in (davtests-no, davtests-yes): Separate test programs
	which require DAV support; only run if DAV is enabled.

	* Makefile.in (test): Pass SRCDIR env var through to run.sh.

	* run.sh: Pass SRCDIR as argv[1] to test programs.

	* compress.c (init): New function.  Use 'newsfn' global for
	filename of NEWS file.

Sun Jan 20 13:06:40 2002  Joe Orton  <joe@manyfish.co.uk>

	* Makefile.in: Fixes for VPATH build

Mon Jan 14 01:58:39 2002  Joe Orton  <joe@manyfish.co.uk>

	* basic.c (content_type): Add harsher charset handling tests.

Sun Jan 13 14:01:57 2002  Joe Orton  <joe@manyfish.co.uk>

	* lock.c (lock_timeout): Use make_session. 

	* acl.c (test_acl): Use make_session.

	* auth.c (basic, retries): Use make_session.

Sun Jan 13 14:01:13 2002  Joe Orton  <joe@manyfish.co.uk>

	* utils.c (make_session): New function.

Sun Jan 13 14:00:34 2002  Joe Orton  <joe@manyfish.co.uk>

	* basic.c (content_type): Rename ctype to ct; check if charset is
	unexpectedly set.

Sun Jan 13 13:58:07 2002  Joe Orton  <joe@manyfish.co.uk>

	* basic.c: New file.

	* Makefile.in: Add `basic' test suite.

Mon Jan  7 22:05:33 2002  Joe Orton  <joe@manyfish.co.uk>

	* Makefile.in: Don't pass CFLAGS to CC when linking.

Mon Jan  7 21:46:03 2002  Joe Orton  <joe@manyfish.co.uk>

	* lock.c: New file.

	* Makefile.in: Add 'lock' to TESTS, build lock.

Mon Jan  7 21:17:21 2002  Joe Orton  <joe@manyfish.co.uk>

	* skeleton.c: Add skeleton test suite.

Tue Jan  1 21:47:09 2002  Joe Orton  <joe@manyfish.co.uk>

	* Makefile.in: Use CPPFLAGS correctly.

Sun Dec  9 14:02:50 2001  Joe Orton  <joe@manyfish.co.uk>

	* string-tests.c (ONCMP): New macro.  (everywhere): Use it.
	(grow): Add ne_buffer_grow test.

Sun Dec  9 13:12:27 2001  Joe Orton  <joe@manyfish.co.uk>

	* string-tests.c (concat2, concat3): New ne_buffer_concat tests.

Sat Dec  1 18:35:29 2001  Joe Orton  <joe@manyfish.co.uk>

	* utils.c (any_request): Don't set the error context.

Sat Dec  1 12:21:48 2001  Joe Orton  <joe@manyfish.co.uk>

	* auth.c (retry_failure, retry_fail_cb, retry_fail_serve): New
	functions.

Tue Nov 27 21:24:22 2001  Joe Orton  <joe@manyfish.co.uk>

	* request.c (s_progress, provide_progress, send_progress): New
	functions.

Sun Nov 18 19:11:23 2001  Joe Orton  <joe@manyfish.co.uk>

	* auth.c (send_response): New function.  (auth_serve): Simplify
	using send_response.  (retry_serve, retry_cb, retries): New
	functions.

Sat Nov 17 22:32:29 2001  Joe Orton  <joe@manyfish.co.uk>

	* auth.c (auth_serve, basic): Simplify, use a persistent
	connection and any_request() to work with --disable-dav builds.

Sat Nov 17 22:30:43 2001  Joe Orton  <joe@manyfish.co.uk>

	* utils.c (any_request): New function.

Sun Oct 28 19:38:05 2001  Joe Orton  <joe@manyfish.co.uk>

	* Makefile.in: Use explicit link rules.

Fri Oct 26 20:08:33 2001  Joe Orton  <joe@manyfish.co.uk>

	* request.c (persist_timeout): Test behaviour when connection
	closes after between 1 and 10 requests.

Fri Oct 26 20:04:27 2001  Joe Orton  <joe@manyfish.co.uk>

	* utils.c (many_serve_string): New function.

Sun Oct  7 17:48:53 2001  Joe Orton  <joe@manyfish.co.uk>

	* utils.c: New file.

	* request.c (single_serve_string): Moved to utils.c.

	* Makefile.in: Link utils.o into all libtest.a. Move libtest.a
	into this directory.

Sun Oct  7 15:01:47 2001  Joe Orton  <joe@manyfish.co.uk>

	* request.c (persist, persist_timeout, serve_twice, is_alive): New
	functions.  (closed_connection): Avoid race condition.

Sat Oct  6 14:33:42 2001  Joe Orton  <joe@manyfish.co.uk>

	* request.c (prepare_request, finish_request): Renamed from
	make_request, destroy_request.  (skip_interim_1xx, skip_many_1xx,
	skip_1xx_hdrs): New functions.

Wed Oct  3 00:03:33 2001  Joe Orton  <joe@manyfish.co.uk>

	* request.c (fail_request): Optionally include a request body, and
	optionally presume the server runs "forever".  (all callers
	changed).  (serve_close, closed_connection): New function.

Sat Sep 29 14:08:16 2001  Joe Orton  <joe@manyfish.co.uk>

	* compress.c (fetch): Update for new decompression API.

Sat Sep 29 11:21:56 2001  Joe Orton  <joe@manyfish.co.uk>

	* compress.c: New file.

	* Makefile.in: Build compress test, and some its helpers.  Add
	-lneon to LIBS, and pick up NEON_CFLAGS.

Thu Sep 27 20:31:51 2001  Joe Orton  <joe@manyfish.co.uk>

	* utils.h: New file.

	* request.c: Moved ONREQ() into utils.h

Mon Aug 27 00:34:56 2001  Joe Orton  <joe@manyfish.co.uk>

	* regress.c: New file.

Mon Aug 27 00:33:13 2001  Joe Orton  <joe@manyfish.co.uk>

	* request.c (discard_request): Moved into common/child.c.
	(make_request, destroy_request): Convenience functions.
	(serve_non_http, not_http): New test.

Sun Jun 24 22:15:46 2001  Joe Orton  <joe@manyfish.co.uk>

	* test.[ch], child.[ch]: Moved into 'common' subdir.

	* Makefile.in: Updated likewise.

Tue Jun 19 22:00:06 2001  Joe Orton  <joe@manyfish.co.uk>

	* util-tests.c (parse_dates): Test date parsers.

Sun Jun 10 17:36:11 2001  Joe Orton  <joe@manyfish.co.uk>

	* request.c (infinite_headers, unbounded_headers): New test.

Sun Jun 10 16:38:53 2001  Joe Orton  <joe@manyfish.co.uk>

	* child.c [HAVE_PIPE]: Use a pipe between child and parent to know
	when the child is ready to accept connections.  Avoids boring
	sleep()ing.

Fri Jun  8 21:19:35 2001  Joe Orton  <joe@manyfish.co.uk>

	* tests.c (segv, main): Remove SEGV handler in favour of useful
	core dumps.

Mon Jun  4 01:15:52 2001  Joe Orton  <joe@manyfish.co.uk>

	* child.c (server_socket): Set socket family correctly.

Thu May 31 08:58:41 2001  Joe Orton  <joe@manyfish.co.uk>

	* util-tests.c (md5_alignment): New test for MD5 alignment issue
	on Sparc.

Thu May 31 00:40:43 2001  Joe Orton  <joe@manyfish.co.uk>

	* child.c (minisleep): Just sleep for a second anyway.

Thu May 31 00:19:16 2001  Joe Orton  <joe@manyfish.co.uk>

	* child.c (server_socket): Casts for bind and setsockopt arguments.

Thu May 31 00:02:21 2001  Joe Orton  <joe@manyfish.co.uk>

	* request.c (send_bodies): Test callback-provided request bodies.

Wed May 30 22:37:08 2001  Joe Orton  <joe@manyfish.co.uk>

	* tests.c (child_segv): New function.  (in_child): Install
	different SEGV handler.  (segv): Sleep so the re-raised SEGV
	signal gets handled and we dump core.

Wed May 30 19:24:32 2001  Joe Orton  <joe@manyfish.co.uk>

	* request.c (send_bodies): New test for sending request bodies.

Wed May 16 21:19:49 2001  Joe Orton  <joe@manyfish.co.uk>

	* request.c (expect_response): Renamed, fold together
	single_request and do_get_request.  (all callers changed)

Wed May 16 20:59:19 2001  Joe Orton  <joe@manyfish.co.uk>

	* request.c (construct_get, run_request): New functions.
	(fold_headers, fold_many_headers, multi_header): New tests.

Sat May 12 17:37:36 2001  Joe Orton  <joe@manyfish.co.uk>

	* server.c: Renamed from http-tests.c.

Sat May 12 17:35:05 2001  Joe Orton  <joe@manyfish.co.uk>

	* child.c (minisleep): New function.  (spawn_server, reap_server):
	New functions.  (server_child): Call in_child.

Sat May 12 17:33:57 2001  Joe Orton  <joe@manyfish.co.uk>

	* tests.c (main): Open two log files for debugging messages.
	(in_child): Switch to debug using child log.

Sat May 12 11:18:18 2001  Joe Orton  <joe@manyfish.co.uk>

	* tests.c (main): Call sock_init.  (segv): Re-raise SEGV signal
	after printing message.

Mon May  7 10:38:50 2001  Joe Orton  <joe@manyfish.co.uk>

	* request.c (chunk_syntax_1, chunk_syntax_2, chunk_syntax_3,
	chunk_syntax_4, chunk_syntax_5): Split down from chunk_syntax.

Mon May  7 10:37:38 2001  Joe Orton  <joe@manyfish.co.uk>

	* util-tests.c (base64): Update for ne_base64() changes.  Add
	tests for binary data.

Sun May  6 23:55:36 2001  Joe Orton  <joe@manyfish.co.uk>

	* tests.h (ON): Use global buffer 'on_err_buf'.  Make 'name'
	variable public.

Sun May  6 23:53:06 2001  Joe Orton  <joe@manyfish.co.uk>

	* request.c (single_serve_string): General version of
	single_serve_*.  (single_request): Pass in expected response body.
	(single_get_*): Use new single_request/single_serve_string.
	(chunk_syntax): Add some tests for chunk syntax.

Sun May  6 22:29:36 2001  Joe Orton  <joe@manyfish.co.uk>

	* child.c, child.h: New files, split down from request.c.

Sun May  6 21:53:28 2001  Joe Orton  <joe@manyfish.co.uk>

	* request.c (spawn_server): Sleep for a while to let the server
	get going.  (do_request): Use passed parameters when creating
	request.

Sun May  6 21:34:27 2001  Joe Orton  <joe@manyfish.co.uk>

	* request.c (spawn_server): Use callback to handle the server side
	of connection.  (single_request): New function.  (single_get_eof,
	single_get_clength, single_get_chunked): New functions.
	(reap_server): New function.

Sun May  6 20:02:32 2001  Joe Orton  <joe@manyfish.co.uk>

	* request.c: New file.

Wed May  2 12:08:53 2001  Joe Orton  <joe@manyfish.co.uk>

	* string-tests.c (token1, token2, nulls, empty, quoted, badquotes,
	shave, combo): New tests for ne_token and ne_shave.

Wed May  2 12:04:52 2001  Joe Orton  <joe@manyfish.co.uk>

	* string-tests.c: Updated for sbuffer -> ne_buffer changes.

Wed May  2 01:08:45 2001  Joe Orton  <joe@manyfish.co.uk>

	* Makefile.in (check): Alias for test goal.

Wed May  2 01:08:36 2001  Joe Orton  <joe@manyfish.co.uk>

	* tests.c (segv): Disable SEGV handler once handling it.

Sun Apr 29 14:57:59 2001  Joe Orton  <joe@manyfish.co.uk>

	* uri-tests.c (slash): Check behaviour of passing zero-length URI.

Sun Apr 29 13:43:59 2001  Joe Orton  <joe@manyfish.co.uk>

	* Makefile.in (clean): New target.  (libtest.a): Depend on libneon
	to force rebuilds when necessary.  (all): Build but don't test.

Sun Apr 29 13:41:13 2001  Joe Orton  <joe@manyfish.co.uk>

	* util-tests.c: Add status line with leading garbage.

Sun Apr 29 13:39:53 2001  Joe Orton  <joe@manyfish.co.uk>

	* util-tests.c (status_lines): Add some tests for invalid status
	lines too.

Sun Apr 29 13:38:31 2001  Joe Orton  <joe@manyfish.co.uk>

	* tests.c (main): Use basename(argv[0]) as suite name.  Fail if no
	tests are in the functions vector.

Sun Apr 29 11:06:45 2001  Joe Orton  <joe@manyfish.co.uk>

	* tests.c (segv): New function.  (main): Add SIGSEGV handler.

Fri Apr 27 00:00:12 2001  Joe Orton  <joe@manyfish.co.uk>

	* util-tests.c (base64): New test.

Thu Apr 26 22:39:44 2001  Joe Orton  <joe@manyfish.co.uk>

	* uri-tests.c (just_hostname, just_path, null_uri): New tests.

Thu Apr 26 22:03:58 2001  Joe Orton  <joe@manyfish.co.uk>

	* util-tests.c (md5): Test of MD5 functions.

Mon Apr 23 23:08:02 2001  Joe Orton  <joe@manyfish.co.uk>

	* http-tests.c (simple_head): Add HEAD test.

Mon Apr 23 22:49:52 2001  Joe Orton  <joe@manyfish.co.uk>

	* http-tests.c (simple_get): Check for EOF after reading response
	body of HTTP/1.0 GET request.

	(null_resource): New function, test for 404 on null resource.


